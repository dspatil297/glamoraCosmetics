{% comment %} Glamora Countdown / Offer Banner â€” dark strip, countdown, CTAs {% endcomment %}
{% assign end_date = section.settings.end_date | default: '2026-12-31T23:59:59' %}
<div class="countdown-banner full-width" style="background-color: {{ section.settings.background_color | default: '#2C2C2C' }};">
  <div class="countdown-banner__inner">
    <h2 class="countdown-banner__heading">{{ section.settings.heading | default: 'Enjoy the best quality cosmetics' }}</h2>
    <div class="countdown-banner__timer" data-end="{{ end_date }}">
      <span class="countdown-banner__block"><span class="countdown-banner__value" data-days>00</span> <span class="countdown-banner__label">DD</span></span>
      <span class="countdown-banner__block"><span class="countdown-banner__value" data-hours>00</span> <span class="countdown-banner__label">HH</span></span>
      <span class="countdown-banner__block"><span class="countdown-banner__value" data-minutes>00</span> <span class="countdown-banner__label">MM</span></span>
      <span class="countdown-banner__block"><span class="countdown-banner__value" data-seconds>00</span> <span class="countdown-banner__label">SS</span></span>
    </div>
    <div class="countdown-banner__ctas">
      <a href="{{ section.settings.cta_url | default: routes.all_products_collection_url }}" class="btn btn--primary" style="--color-button: #fff; --color-button-hover: var(--color-background-alt); color: var(--color-foreground);">{{ section.settings.cta_text | default: 'SHOP NOW' }}</a>
      {% if section.settings.cta2_url != blank %}<a href="{{ section.settings.cta2_url }}" class="btn btn--secondary" style="border-color: #fff; color: #fff;">{{ section.settings.cta2_text | default: 'READ MORE' }}</a>{% endif %}
    </div>
  </div>
</div>

{% stylesheet %}
  .countdown-banner { padding: var(--section-padding-block) var(--page-margin); text-align: center; color: #fff; }
  .countdown-banner__heading { font-family: var(--font-heading); font-size: clamp(1.5rem, 2.5vw, 2rem); margin: 0 0 1.5rem; }
  .countdown-banner__timer { display: flex; justify-content: center; gap: 1rem; flex-wrap: wrap; margin-bottom: 1.5rem; }
  .countdown-banner__block { display: flex; flex-direction: column; align-items: center; min-width: 4rem; }
  .countdown-banner__value { font-size: 1.75rem; font-weight: 700; }
  .countdown-banner__label { font-size: 0.6875rem; letter-spacing: 0.1em; opacity: 0.9; }
  .countdown-banner__ctas { display: flex; justify-content: center; gap: 1rem; }
{% endstylesheet %}

<script>
  (function() {
    var el = document.querySelector('.countdown-banner__timer[data-end]');
    if (!el) return;
    var end = new Date(el.getAttribute('data-end')).getTime();
    function update() {
      var now = new Date().getTime();
      var d = Math.max(0, Math.floor((end - now) / 86400000));
      var h = Math.max(0, Math.floor(((end - now) % 86400000) / 3600000));
      var m = Math.max(0, Math.floor(((end - now) % 3600000) / 60000));
      var s = Math.max(0, Math.floor(((end - now) % 60000) / 1000));
      var daysEl = el.querySelector('[data-days]'); if (daysEl) daysEl.textContent = String(d).padStart(2, '0');
      var hoursEl = el.querySelector('[data-hours]'); if (hoursEl) hoursEl.textContent = String(h).padStart(2, '0');
      var minutesEl = el.querySelector('[data-minutes]'); if (minutesEl) minutesEl.textContent = String(m).padStart(2, '0');
      var secondsEl = el.querySelector('[data-seconds]'); if (secondsEl) secondsEl.textContent = String(s).padStart(2, '0');
    }
    update();
    setInterval(update, 1000);
  })();
</script>

{% schema %}
{
  "name": "Countdown banner",
  "tag": "section",
  "class": "section-countdown",
  "settings": [
    { "type": "text", "id": "heading", "label": "Heading", "default": "Enjoy the best quality cosmetics" },
    { "type": "text", "id": "end_date", "label": "End date (ISO)", "default": "2026-12-31T23:59:59", "info": "e.g. 2026-12-31T23:59:59" },
    { "type": "color", "id": "background_color", "label": "Background", "default": "#2C2C2C" },
    { "type": "text", "id": "cta_text", "label": "Button text", "default": "SHOP NOW" },
    { "type": "url", "id": "cta_url", "label": "Button link" },
    { "type": "text", "id": "cta2_text", "label": "Second button text", "default": "READ MORE" },
    { "type": "url", "id": "cta2_url", "label": "Second button link" }
  ],
  "presets": [{ "name": "Countdown banner" }]
}
{% endschema %}
