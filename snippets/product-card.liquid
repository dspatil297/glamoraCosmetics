{% comment %}
  Glamora product card: High-converting design with hover effects, ratings, quick actions
  Usage: {% render 'product-card', product: product, show_badge: false %}
{% endcomment %}
<div class="product-card card">
  <div class="product-card__image-wrap">
    <a href="{{ product.url }}" class="product-card__image-link">
      {% if product.featured_image %}
        {{ product.featured_image | image_url: width: 600, height: 600, crop: 'center' | image_tag: loading: 'lazy', class: 'product-card__img product-card__img--primary', alt: product.featured_image.alt | escape }}
        {% if product.images[1] %}
          {{ product.images[1] | image_url: width: 600, height: 600, crop: 'center' | image_tag: loading: 'lazy', class: 'product-card__img product-card__img--secondary', alt: product.title | escape }}
        {% endif %}
      {% else %}
        <div class="product-card__placeholder" style="background-image: url('https://images.unsplash.com/photo-1556228578-0d85b1a4d571?w=600&h=600&fit=crop&auto=format'); background-size: cover; background-position: center;"></div>
      {% endif %}
    </a>
    
    {% comment %} Badges {% endcomment %}
    {% if show_badge and product.metafields.custom.badge == 'new' or product.tags contains 'new' %}
      <span class="product-card__badge product-card__badge--new">NEW</span>
    {% endif %}
    {% if product.compare_at_price > product.price %}
      <span class="product-card__badge product-card__badge--sale">{{ product.compare_at_price | minus: product.price | times: 100.0 | divided_by: product.compare_at_price | round }}% OFF</span>
    {% endif %}
    
    {% comment %} Hover Actions Panel {% endcomment %}
    <div class="product-card__hover-actions">
      <form action="{{ routes.cart_add_url }}" method="post" enctype="multipart/form-data" class="product-card__quick-add" data-product-id="{{ product.id }}" onclick="event.stopPropagation();">
        <input type="hidden" name="id" value="{{ product.selected_or_first_available_variant.id }}">
        <button type="submit" class="product-card__quick-add-btn" aria-label="Quick add {{ product.title }} to cart" onclick="event.stopPropagation();">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="9" cy="21" r="1"/><circle cx="20" cy="21" r="1"/><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/></svg>
          <span>Quick Add</span>
        </button>
      </form>
      <a href="{{ product.url }}" class="product-card__quick-view" aria-label="Quick view {{ product.title }}">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>
        <span>Quick View</span>
      </a>
    </div>
    
    {% comment %} Availability Indicator {% endcomment %}
    {% unless product.available %}
      <div class="product-card__availability product-card__availability--sold-out">Sold Out</div>
    {% else %}
      <div class="product-card__availability product-card__availability--in-stock">In Stock</div>
    {% endunless %}
  </div>
  
  <div class="product-card__content">
    <a href="{{ product.url }}" class="product-card__link">
      {% comment %} Star Rating {% endcomment %}
      {% if product.metafields.reviews.rating.value != blank %}
        <div class="product-card__rating">
          {% assign rating = product.metafields.reviews.rating.value | times: 1.0 %}
          {% for i in (1..5) %}
            <span class="product-card__star {% if i <= rating %}product-card__star--filled{% endif %}">★</span>
          {% endfor %}
          <span class="product-card__rating-count">({{ product.metafields.reviews.rating_count.value | default: '0' }})</span>
        </div>
      {% elsif show_placeholder_rating %}
        <div class="product-card__rating">
          <span class="product-card__star product-card__star--filled">★</span>
          <span class="product-card__star product-card__star--filled">★</span>
          <span class="product-card__star product-card__star--filled">★</span>
          <span class="product-card__star product-card__star--filled">★</span>
          <span class="product-card__star product-card__star--filled">★</span>
          <span class="product-card__rating-count">(127)</span>
        </div>
      {% endif %}
      
      <h3 class="product-card__title">{{ product.title }}</h3>
      
      {% comment %} Pricing {% endcomment %}
      {% if product.compare_at_price > product.price %}
        <div class="product-card__pricing">
          <span class="product-card__compare-price">{{ product.compare_at_price | money }}</span>
          <span class="product-card__price">{{ product.price | money }}</span>
        </div>
      {% else %}
        <p class="product-card__price">{{ product.price | money }}</p>
      {% endif %}
    </a>
    
    {% comment %} Color Swatches (if variants available) {% endcomment %}
    {% if product.variants.size > 1 and product.options_with_values.size > 0 %}
      {% assign first_option = product.options_with_values[0] %}
      {% if first_option.name == 'Color' or first_option.name == 'Colour' %}
        <div class="product-card__swatches">
          {% for value in first_option.values limit: 5 %}
            <span class="product-card__swatch" style="background-color: {{ value | downcase | replace: ' ', '-' }};" title="{{ value }}"></span>
          {% endfor %}
          {% if first_option.values.size > 5 %}
            <span class="product-card__swatch-more">+{{ first_option.values.size | minus: 5 }}</span>
          {% endif %}
        </div>
      {% endif %}
    {% endif %}
    
    {% comment %} Add to Cart Button (always visible on mobile) {% endcomment %}
    <form action="{{ routes.cart_add_url }}" method="post" enctype="multipart/form-data" class="product-card__form" data-product-id="{{ product.id }}">
      <input type="hidden" name="id" value="{{ product.selected_or_first_available_variant.id }}">
      <button type="submit" class="btn btn--primary product-card__cta" aria-label="Add {{ product.title }} to cart">
        <span class="product-card__cta-text">Add to Cart</span>
        <span class="product-card__cta-icon">+</span>
      </button>
    </form>
  </div>
</div>

{% stylesheet %}
  .product-card {
    color: inherit;
    display: flex;
    flex-direction: column;
    position: relative;
    background: var(--color-background);
    border-radius: var(--style-border-radius-cards);
    overflow: hidden;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }
  .product-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 8px 24px rgba(0,0,0,0.12);
  }
  
  .product-card__image-wrap {
    position: relative;
    aspect-ratio: 1;
    overflow: hidden;
    background: var(--color-background-alt);
  }
  .product-card__image-link {
    display: block;
    width: 100%;
    height: 100%;
  }
  .product-card__img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.5s ease, opacity 0.3s ease;
  }
  .product-card__img--primary {
    transform: scale(1);
  }
  .product-card__img--secondary {
    position: absolute;
    inset: 0;
    opacity: 0;
    transform: scale(1.1);
  }
  .product-card:hover .product-card__img--primary { 
    opacity: 0; 
    transform: scale(1.05);
  }
  .product-card:hover .product-card__img--secondary { 
    opacity: 1; 
    transform: scale(1);
  }
  .product-card__placeholder { 
    width: 100%; 
    height: 100%; 
  }
  
  /* Badges */
  .product-card__badge {
    position: absolute;
    top: 0.75rem;
    left: 0.75rem;
    background: var(--color-primary);
    color: #fff;
    font-size: 0.6875rem;
    font-weight: 700;
    letter-spacing: 0.1em;
    padding: 0.375rem 0.625rem;
    border-radius: 4px;
    z-index: 2;
    text-transform: uppercase;
  }
  .product-card__badge--sale {
    background: #d32f2f;
    top: auto;
    bottom: 0.75rem;
    left: 0.75rem;
  }
  .product-card__badge--new {
    background: var(--color-primary);
  }
  
  /* Hover Actions Panel */
  .product-card__hover-actions {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    display: flex;
    gap: 0.5rem;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s ease, visibility 0.3s ease;
    z-index: 3;
  }
  .product-card:hover .product-card__hover-actions {
    opacity: 1;
    visibility: visible;
  }
  .product-card__quick-add-btn,
  .product-card__quick-view {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem 1rem;
    background: #fff;
    color: var(--color-foreground);
    border: none;
    border-radius: var(--style-border-radius-buttons);
    font-size: 0.8125rem;
    font-weight: 600;
    cursor: pointer;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    transition: transform 0.2s ease, background-color 0.2s ease;
    text-decoration: none;
  }
  .product-card__quick-add-btn:hover,
  .product-card__quick-view:hover {
    transform: scale(1.05);
    background: var(--color-button);
    color: #fff;
  }
  .product-card__quick-add-btn svg,
  .product-card__quick-view svg {
    width: 18px;
    height: 18px;
  }
  
  /* Availability Indicator */
  .product-card__availability {
    position: absolute;
    bottom: 0.75rem;
    right: 0.75rem;
    font-size: 0.6875rem;
    font-weight: 600;
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
    z-index: 2;
  }
  .product-card__availability--in-stock {
    background: rgba(76, 175, 80, 0.9);
    color: #fff;
  }
  .product-card__availability--sold-out {
    background: rgba(158, 158, 158, 0.9);
    color: #fff;
  }
  
  /* Content */
  .product-card__content { 
    padding: 1rem; 
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    flex: 1;
  }
  .product-card__link {
    text-decoration: none;
    color: inherit;
    display: block;
  }
  
  /* Rating */
  .product-card__rating {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    margin-bottom: 0.5rem;
  }
  .product-card__star {
    color: #ddd;
    font-size: 0.875rem;
  }
  .product-card__star--filled {
    color: #ffa500;
  }
  .product-card__rating-count {
    font-size: 0.75rem;
    color: var(--color-text-muted);
    margin-left: 0.25rem;
  }
  
  /* Title */
  .product-card__title {
    font-family: var(--font-heading);
    font-size: 0.9375rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin: 0;
    color: var(--color-foreground);
    line-height: 1.4;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
  
  /* Pricing */
  .product-card__pricing { 
    display: flex; 
    align-items: baseline; 
    gap: 0.5rem; 
    flex-wrap: wrap; 
  }
  .product-card__price {
    font-weight: 700;
    font-size: 1.125rem;
    color: var(--color-foreground);
  }
  .product-card__compare-price {
    font-size: 0.875rem;
    color: var(--color-text-muted);
    text-decoration: line-through;
  }
  
  /* Color Swatches */
  .product-card__swatches {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-top: 0.25rem;
  }
  .product-card__swatch {
    width: 20px;
    height: 20px;
    border-radius: 50%;
    border: 2px solid var(--color-border);
    cursor: pointer;
    transition: transform 0.2s ease, border-color 0.2s ease;
  }
  .product-card__swatch:hover {
    transform: scale(1.2);
    border-color: var(--color-primary);
  }
  .product-card__swatch-more {
    font-size: 0.75rem;
    color: var(--color-text-muted);
  }
  
  /* Add to Cart Button */
  .product-card__form { 
    margin-top: auto;
    padding-top: 0.75rem;
  }
  .product-card__cta {
    width: 100%;
    padding: 0.75rem 1rem;
    font-size: 0.8125rem;
    font-weight: 600;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    transition: transform 0.2s ease, box-shadow 0.2s ease, background-color 0.2s ease;
    cursor: pointer;
  }
  .product-card__cta-icon {
    font-size: 1.125rem;
    font-weight: 300;
    line-height: 1;
  }
  .product-card:hover .product-card__cta {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0,0,0,0.2);
  }
  
  /* Mobile Optimizations */
  @media (max-width: 768px) {
    .product-card__hover-actions {
      display: none;
    }
    .product-card__availability {
      font-size: 0.625rem;
      padding: 0.2rem 0.4rem;
    }
    .product-card__content {
      padding: 0.875rem;
    }
    .product-card__title {
      font-size: 0.875rem;
    }
    .product-card__price {
      font-size: 1rem;
    }
  }
  
  @media (hover: none) {
    .product-card__hover-actions {
      display: none;
    }
  }
{% endstylesheet %}
